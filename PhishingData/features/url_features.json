{
  "version": "2.0",
  "notes": "URL-centric features (no network calls). Assumes columns: url, domain, url_canon, and parsed host/path/query available at extraction time.",
  "features": [
    {"name": "url_len", "modality": "url", "type": "len", "source": "url"},
    {"name": "host_len", "modality": "url", "type": "len", "source": "host"},
    {"name": "path_len", "modality": "url", "type": "len", "source": "path"},
    {"name": "query_len", "modality": "url", "type": "len", "source": "query"},
    {"name": "num_params", "modality": "url", "type": "regex_count", "pattern": "(?<!%)(&|\\?)\\w+=", "source": "url"},
    {"name": "num_subdomains", "modality": "url", "type": "subdomain_count", "source": "host"},
    {"name": "tld_len", "modality": "url", "type": "tld_len", "source": "host"},
    {"name": "digits_in_host", "modality": "url", "type": "regex_count", "pattern": "\\d", "source": "host"},
    {"name": "hyphens_in_host", "modality": "url", "type": "regex_count", "pattern": "-", "source": "host"},
    {"name": "dots_in_path", "modality": "url", "type": "regex_count", "pattern": "\\.", "source": "path"},
    {"name": "slashes_count", "modality": "url", "type": "regex_count", "pattern": "/", "source": "path"},
    {"name": "has_multiple_slashes", "modality": "url", "type": "regex_bool", "pattern": "//.+/", "source": "path"},
    {"name": "has_port", "modality": "url", "type": "regex_bool", "pattern": ":[0-9]{2,5}$", "source": "host"},
    {"name": "has_at_symbol", "modality": "url", "type": "regex_bool", "pattern": "@", "source": "url"},
    {"name": "has_pct_encoding", "modality": "url", "type": "regex_bool", "pattern": "%[0-9A-Fa-f]{2}", "source": "url"},
    {"name": "has_unicode_punycode", "modality": "url", "type": "regex_bool", "pattern": "xn--", "source": "host"},
    {"name": "host_is_ipv4", "modality": "url", "type": "regex_bool", "pattern": "^(?:\\d{1,3}\\.){3}\\d{1,3}$", "source": "host"},
    {"name": "starts_https", "modality": "url", "type": "regex_bool", "pattern": "(?i)^https://", "source": "url"},
    {"name": "has_ext_like_html", "modality": "url", "type": "regex_bool", "pattern": "\\.(php|asp|aspx|jsp|cfm|html?)($|[?&#])", "source": "path"},
    {"name": "shortener_domain", "modality": "url", "type": "domain_in_list", "list": ["bit.ly","goo.gl","t.co","tinyurl.com","ow.ly","is.gd","buff.ly","cutt.ly","rebrand.ly","t.ly"], "source": "host"},
    {"name": "keyword_login", "modality": "url", "type": "regex_bool", "pattern": "(?i)login|signin|account|verify|secure", "source": "url"},
    {"name": "keyword_bank", "modality": "url", "type": "regex_bool", "pattern": "(?i)bank|paypal|wallet|invoice|billing|refund", "source": "url"},
    {"name": "keyword_arabic_sensitive", "modality": "url", "type": "regex_bool", "pattern": "تسجيل|حساب|تحقق|أمان|بطاقة|دفع|بنك|رصيد|فاتورة", "source": "url"},
    {"name": "query_has_token_like", "modality": "url", "type": "regex_bool", "pattern": "(?i)(token|session|auth|password|pass)=.{6,}", "source": "query"},
    {"name": "query_has_email", "modality": "url", "type": "regex_bool", "pattern": "(?i)[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}", "source": "query"},
    {"name": "rare_domain_flag", "modality": "url", "type": "lookup_bool", "lookup": "is_rare_domain", "source": "domain"},
    {"name": "top1m_umbrella", "modality": "url", "type": "lookup_bool", "lookup": "umbrella_top1m", "source": "domain"},
    {"name": "top1m_majestic", "modality": "url", "type": "lookup_bool", "lookup": "majestic_top1m", "source": "domain"},
    {"name": "path_suspicious_mix", "modality": "url", "type": "regex_bool", "pattern": "(?i)(%2e|\\.|\\-){2,}(/|$)|([A-Za-z0-9]{24,})", "source": "path"},
    {"name": "has_double_extension", "modality": "url", "type": "regex_bool", "pattern": "\\.(zip|rar|7z|exe)\\.(php|html?)$", "source": "path"}
  ]
}
